fragment MemberFields on Membership {
  id
  rootAccount
  controllerAccount
  handle
  metadata {
    name
    about
    # avatar {} - Should be fetched from the Storage system.
    # See https://github.com/Joystream/pioneer/issues/54
  }
  isVerified
  isFoundingMember
  inviteCount
}

query GetMembers($rootAccount_in: [String!], $controllerAccount_in: [String!], $orderBy: MembershipOrderByInput) {
  memberships(
    where: { rootAccount_in: $rootAccount_in, controllerAccount_in: $controllerAccount_in }
    orderBy: $orderBy
  ) {
    ...MemberFields
  }
}

fragment MemberWithDetails on Membership {
  ...MemberFields
  registeredAtTime
  registeredAtBlock {
    ...BlockFields
  }
  invitees {
    ...MemberFields
  }
}

query GetMember($where: MembershipWhereUniqueInput!) {
  membershipByUniqueInput(where: $where) {
    ...MemberWithDetails
  }
}

query SearchMembers($text: String!, $limit: Int) {
  memberships(where: { handle_contains: $text }, limit: $limit) {
    ...MemberFields
  }
}

query GetMembershipsConnection(
  $where: MembershipWhereInput,
  $orderBy: MembershipOrderByInput,
  $first: Int,
  $after: String,
  $last: Int,
  $before: String
) {
  membershipsConnection(
    where: $where,
    orderBy: $orderBy,
    first: $first,
    after: $after,
    last: $last,
    before: $before
  ) {
    edges {
      cursor
      node {
        ...MemberFields
      }
    }
    pageInfo {
      startCursor
      endCursor
      hasNextPage
      hasPreviousPage
    }
    totalCount
  }
}
